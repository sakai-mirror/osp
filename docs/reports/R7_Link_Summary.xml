<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--
	Notes:
	
	Each report MUST have a different idString.  This is how saved reports are
	linked back to the report definition
    
-->
<beans>    

    
    <!-- 
    
    	This is an Indiana University Report.  It is to be used as an example of an
    	advanced report that uses form data.  The form that this report is based upon is
    	included in this folder
    
     -->
  <bean id="linkSummaryDirectDB"
        class="org.sakaiproject.reports.model.ReportDefinition">

        <property name="idString">
            <value>linkSummaryDirectDB</value>
        </property>
        <property name="usesWarehouse"><value>false</value></property>
        <property name="title">
            <value>
                Link Summary
            </value>
        </property>
        <property name="query">
           <list>
           		<value><![CDATA[
              		select activity_ref as activityref_ACTIVITY, TAG_CRITERIA_REF as TAG_CRITERIAREF
              		From TAGGABLE_LINK 
              		where 'dummyvalue' != ? 
              			and TAG_CRITERIA_REF in (?)
					]]>
              </value>
              <value><![CDATA[
					select mlcr.description as rowName, count(mlcr.description) as numCols
					from osp_scaffolding s
						join osp_scaffolding_criteria scr on scr.scaffolding_id = s.id
						join osp_scaffolding_levels slv on slv.scaffolding_id = s.id
						join osp_matrix_label mlcr on scr.elt = mlcr.id
						join osp_matrix_label mllv on slv.elt = mllv.id
					where s.id = ?
						and 'foo' not in (?)
					group by mlcr.description, scr.seq_num
					order by scr.seq_num
              ]]>
              </value>
           		<value><![CDATA[
           			select s.title, mlcr.id as row_id, mlcr.description as rowName, mllv.id as colId, mllv.description as colName 
					from osp_scaffolding s
						join osp_scaffolding_criteria scr on scr.scaffolding_id = s.id
						join osp_scaffolding_levels slv on slv.scaffolding_id = s.id
						join osp_matrix_label mlcr on scr.elt = mlcr.id
						join osp_matrix_label mllv on slv.elt = mllv.id
					where s.id = ?
						and 'foo' not in (?)
					order by s.id, scr.seq_num, slv.seq_num
           		]]>
           		</value>
           </list>
        </property>
        <property name="resultProcessors">
           <list>
              <ref bean="org.sakaiproject.reports.service.ResultProcessor.defaultActivityLoader" />
              <ref bean="org.sakaiproject.reports.service.ResultProcessor.defaultCriteriaRefLoader" />
           </list>
        </property>
        <property name="keywords">
            <value>resources</value>
        </property>
        <property name="description">
            <value><![CDATA[
                For each cell in the matrix, list the items that are linked to each cell.  Answers questions for administrators, faculty, assessment coordinators, and 
curriculum committees like: 
 In which classes is outcome X being taught? 
 Which of our courses are (or are not) actively supporting our program assessment activities? 
 Are there critical gaps in our curriculum as suggested by the absence of links for specific outcomes? 
 Where can I find an example of an effective assignment for demonstrating proficiency in outcome X?
 ]]>
            </value>
        </property>
        <property name="siteType">
            <value>portfolioAdmin,portfolio</value>
        </property>
        <property name="defaultXsl">
                <ref bean="standard"/>
        </property>

        <property name="reportDefinitionParams">
            <list>
                <bean class="org.sakaiproject.reports.model.ReportDefinitionParam">
                    <property name="title"><value>Choose a Matrix</value></property>
                    <property name="paramName"><value>matrixId</value></property>
                    <property name="description"><value>To choose a matrix</value></property>
                    <property name="type"><value>string</value></property>
                    <property name="valueType"><value>sql</value></property>
                    <property name="value"><value>SELECT id, title FROM osp_scaffolding WHERE worksiteId = '{worksiteid}' AND publishedBy IS NOT NULL</value></property>
                </bean>
            </list>
        </property>
        <property name="reportDefinitionProcessedParams">
            <list>
                <bean class="org.sakaiproject.reports.model.ReportDefinitionParam">
                    <property name="title"><value></value></property>
                    <property name="paramName"><value>wpdRefs</value></property>
                    <property name="description"><value></value></property>
                    <property name="type"><value>string</value></property>
                    <property name="valueType"><value>multisql</value></property>
                    <property name="value">
                    <value><![CDATA[
	                    select wpd.id as CALC_REF 
	                    From osp_wizard_page_def wpd
							join osp_scaffolding_cell sc on wpd.id = sc.wiz_page_def_id
						where sc.scaffolding_id = ?
					]]></value></property>
					<property name="resultProcessor">
						<ref bean="org.sakaiproject.reports.logic.impl.WizardPageDefReferenceParameterProcessor" />
					</property>
                </bean>
            </list>
        </property>
        <property name="xsls">
            <list>
                <ref bean="passthrough"/>
                <ref bean="standard"/>
                <ref bean="defaultExport2"/>
            </list>
        </property>

    </bean>
    
    <bean id="passthrough" class="org.sakaiproject.reports.model.ReportXsl">
                    <property name="xslLink"><value>/group/PortfolioAdmin/system/Passthrough.xsl</value></property>
                    <property name="isExport"><value>false</value></property>
                    <property name="title"><value>Passthrough</value></property>
                </bean>
                <bean id="standard" class="org.sakaiproject.reports.model.ReportXsl">
                    <property name="xslLink"><value>/group/PortfolioAdmin/R7_Link_Summary.xslt</value></property>
                    <property name="isExport"><value>false</value></property>
                    <property name="title"><value>Standard</value></property>
                </bean>
                <bean id="defaultExport2" class="org.sakaiproject.reports.model.ReportXsl">
                    <property name="title"><value>CSV</value></property>
                    <property name="xslLink"><value>/group/PortfolioAdmin/R7_Link_Summary.xslt</value></property>
                    <property name="isExport"><value>true</value></property>
                    <property name="extension"><value>csv</value></property>
                    <property name="target"><value>_self</value></property>
                    <property name="contentType"><value>application/x-csv</value></property>
                    <property name="resultsPostProcessor">
                        <ref bean="org.sakaiproject.reports.service.ResultsPostProcessor.csvAdvanced"/>
                    </property>
                </bean>

</beans>
