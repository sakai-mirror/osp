<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
	"-//Hibernate/Hibernate Mapping DTD 2.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">
<hibernate-mapping package="org.theospi.portfolio.presentation.model">

   <class name="PresentationTemplate" table="osp_presentation_template">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="name" type="string" column="name" not-null="false"/>
      <property name="description" type="string" column="description" not-null="false"/>
      <property name="includeHeaderAndFooter" type="boolean" column="includeHeaderAndFooter" not-null="false"/>
      <property name="includeComments" type="boolean" column="includeComments" not-null="false"/>
      <property name="published" type="boolean" column="published" not-null="false"/>
      <property name="owner" type="org.sakaiproject.metaobj.shared.mgt.AgentUserType" column="owner_id" not-null="true"/>
      <property name="renderer" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="renderer"/>
      <property name="markup" length="4000" type="string" column="markup"/>
      <property name="propertyPage" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="propertyPage"/>
      <property name="documentRoot" type="string" column="documentRoot"/>
      <set name="items" cascade="all-delete-orphan" inverse="true" lazy="false">
         <key column="template_id"/>
         <one-to-many class="PresentationItemDefinition"/>
      </set>
      <set name="files" cascade="all-delete-orphan" inverse="true" lazy="false">
         <key column="template_id"/>
         <one-to-many class="TemplateFileRef"/>
      </set>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="modified" type="java.util.Date" update="true" not-null="true"/>
      <property name="toolId"
         type="string"
         column="tool_id"
         length="36"
         not-null="true"/>
      <property name="siteId" type="string" update="false" length="36" column="site_id" not-null="true"/>
   </class>

   <class name="PresentationItemDefinition" table="osp_presentation_item_def">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="name" type="string" column="name" not-null="false"/>
      <property name="title" type="string" column="title" not-null="false"/>
      <property name="description" type="string" column="description" not-null="false"/>
      <property name="allowMultiple" type="boolean" column="allowMultiple" not-null="false"/>
      <property name="type" type="string" column="type"/>
      <property name="externalType" type="string" column="external_type"/>
      <property name="sequence" type="int" column="sequence_no" not-null="false"/>
      <many-to-one name="presentationTemplate" column="template_id" not-null="true" class="PresentationTemplate"/>
      <set name="mimeTypes" cascade="all" table="osp_pres_itemdef_mimetype" lazy="true">
         <key column="item_def_id"/>
         <composite-element class="org.theospi.portfolio.shared.model.ItemDefinitionMimeType">
            <property name="primary" column="primaryMimeType" length="36" type="string" not-null="false"/>
            <property name="secondary" column="secondaryMimeType" length="36" type="string" not-null="false"/>
         </composite-element>
      </set>
   </class>

   <class name="TemplateFileRef" table="osp_template_file_ref">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="fileId" column="file_id" length="36" />
      <property name="fileType" column="file_type_id" length="36" />
      <property name="usage" type="string" column="usage_desc" not-null="false"/>
      <many-to-one name="presentationTemplate" column="template_id" not-null="true" class="PresentationTemplate"/>
   </class>

   <class name="Presentation" table="osp_presentation">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="owner" column="owner_id" not-null="true"
         type="org.sakaiproject.metaobj.shared.mgt.AgentUserType"/>
      <many-to-one name="template" column="template_id" not-null="true" class="PresentationTemplate"/>
      <property name="name" type="string" column="name" not-null="false"/>
      <property name="description" type="string" column="description" not-null="false"/>
      <property name="isDefault" type="boolean" column="isDefault" not-null="false"/>
      <property name="isPublic" type="boolean" column="isPublic" not-null="false"/>
      <property name="expiresOn" type="java.util.Date" not-null="false"/>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="modified" type="java.util.Date" update="true" not-null="true"/>
      <property name="properties" type="org.theospi.portfolio.presentation.model.impl.HibernatePresentationProperties"
         not-null="false" column="properties"/>
      <set name="items" table="osp_presentation_item" lazy="false" >
         <key column="presentation_id"/>
         <composite-element class="PresentationItem">
            <property name="artifactId" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="artifact_id"/>
            <many-to-one name="definition" column="item_definition_id" not-null="true" class="PresentationItemDefinition"/>
         </composite-element>
      </set>
      <property name="toolId"
         type="string"
         column="tool_id"
         length="36"
         not-null="false"/>
   </class>

   <class name="PresentationComment" table="osp_presentation_comment">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="title" type="string" column="title" not-null="true"/>
      <property name="comment" column="commentText" length="1024" not-null="false"/>
      <property name="creator" column="creator_id" not-null="true"
         type="org.sakaiproject.metaobj.shared.mgt.AgentUserType"/>
      <many-to-one name="presentation" column="presentation_id" not-null="true" class="Presentation"/>
      <property name="visibility" type="byte" not-null="true"/>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
   </class>


   <class name="PresentationLog" table="osp_presentation_log">
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="viewer" column="viewer_id" not-null="true"
         type="org.sakaiproject.metaobj.shared.mgt.AgentUserType"/>
      <many-to-one name="presentation" column="presentation_id" not-null="true" class="Presentation"/>
      <property name="viewDate" column="view_date" type="java.util.Date" update="false" not-null="false"/>
   </class>

</hibernate-mapping>
