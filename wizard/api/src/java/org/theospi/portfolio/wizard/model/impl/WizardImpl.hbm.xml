<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
	"-//Hibernate/Hibernate Mapping DTD 2.0//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd">
<hibernate-mapping package="org.theospi.portfolio.wizard.model">

   <class name="Wizard" table="osp_wizard" lazy="true">
      <cache usage="nonstrict-read-write"/>

      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="owner" column="owner_id" not-null="true"
         type="org.sakaiproject.metaobj.shared.mgt.AgentUserType"/>
      <property name="name" type="string" column="name" not-null="false"/>
      <property name="description" type="string" column="description" not-null="false"/>
      <property name="keywords" type="string" column="keywords" not-null="false"/>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="modified" type="java.util.Date" update="true" not-null="true"/>
      <property name="siteId" type="string" update="false" length="36" column="site_id" not-null="true"/>
      <property name="toolId" type="string" update="false" length="36" column="tool_id" not-null="true"/>
      <property name="guidanceId" column="guidance_id" not-null="false" length="36"
         type="org.sakaiproject.metaobj.shared.IdType"/>
      <set name="supportItems" lazy="false" inverse="true" cascade="all-delete-orphan">
         <key column="wizard_id" />
         <one-to-many class="WizardSupportItem" />
      </set>
      <property name="published" type="boolean" column="published" not-null="false"/>
      <property name="type" type="string" column="wizard_type" not-null="false"/>
      <bag name="wizardStyleItems" cascade="all-delete-orphan"
            inverse="true" lazy="true">
            <key column="wizard_id" />
            <one-to-many class="WizardStyleItem" />
        </bag>
      <property name="exposedPageId" type="string" length="36" column="exposed_page_id" not-null="false"/>
      <many-to-one name="rootCategory"
         class="WizardCategory" column="root_category"
         cascade="all" unique="true" />
      <property name="sequence" type="int" column="seq_num" not-null="false"/>
   </class>
   
   <class name="WizardStyleItem" table="osp_wizard_style_item" lazy="true">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="baseReference" type="org.theospi.portfolio.shared.mgt.EntityReferenceUserType" />
      <property name="fullReference" type="org.theospi.portfolio.shared.mgt.EntityReferenceUserType" />
      <many-to-one name="wizard" column="wizard_id"
            not-null="true" class="Wizard" cascade="none" />
   </class>

   <class name="WizardSupportItem" table="osp_wizard_support_item" lazy="true">
      <cache usage="nonstrict-read-write"/>

      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <many-to-one name="wizard" column="wizard_id" not-null="true" class="Wizard"/>
      <property name="item" column="item_id" not-null="true" length="36"
         type="org.sakaiproject.metaobj.shared.IdType"/>
      <property name="genericType" type="string" column="generic_type" not-null="true"/>
      <property name="contentType" type="string" column="content_type" not-null="true"/>
   </class>

   <class name="WizardPageSequence" table="osp_wizard_page_sequence">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>
      <property name="sequence" type="int" column="seq_num" not-null="false"/>

      <many-to-one name="category" column="category_id"
          not-null="true" class="WizardCategory" cascade="none" />

      <many-to-one name="wizardPageDefinition"
         class="org.theospi.portfolio.matrix.model.WizardPageDefinition" column="wiz_page_def_id"
         cascade="all" unique="true" />
   </class>

   <class name="WizardCategory" table="osp_wizard_category">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>

      <property name="title" type="string" column="name" not-null="false"/>
      <property name="description" type="string" column="description" not-null="false"/>
      <property name="keywords" type="string" column="keywords" not-null="false"/>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="modified" type="java.util.Date" update="true" not-null="true"/>

      <many-to-one name="wizard" column="wizard_id"
          not-null="false" class="Wizard" cascade="none" />

      <many-to-one name="parentCategory" column="parent_category_id"
          not-null="false" class="WizardCategory" cascade="none" />

      <property name="sequence" type="int" column="seq_num" not-null="false"/>

      <list name="childPages" cascade="all"
          inverse="true" lazy="false">
          <key column="category_id" />
          <index column="seq_num" />
          <one-to-many class="WizardPageSequence" />
      </list>

      <list name="childCategories" cascade="all"
          inverse="true" lazy="false">
          <key column="parent_category_id" />
          <index column="seq_num" />
          <one-to-many class="WizardCategory" />
      </list>

   </class>

   <class name="CompletedWizard" table="osp_completed_wizard">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>

      <property name="owner" column="owner_id" not-null="true"
         type="org.sakaiproject.metaobj.shared.mgt.AgentUserType"/>

      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="lastVisited" type="java.util.Date" update="true" not-null="true"/>

      <many-to-one name="wizard" column="wizard_id"
          not-null="false" class="Wizard" cascade="none" />

      <many-to-one name="rootCategory"
         class="CompletedWizardCategory" column="root_category"
         cascade="all" unique="true" />

   </class>

   <class name="CompletedWizardCategory" table="osp_completed_wiz_category">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>

      <many-to-one name="wizard" column="completed_wizard_id"
          not-null="false" class="CompletedWizard" cascade="none" />

      <many-to-one name="category" column="category_id"
          not-null="false" class="WizardCategory" cascade="none" />

      <property name="expanded" type="boolean" column="expanded" not-null="false"/>

      <property name="sequence" type="int" column="seq_num" not-null="false"/>

      <many-to-one name="parentCategory" column="parent_category_id"
          not-null="false" class="CompletedWizardCategory" cascade="none" />

      <list name="childPages" cascade="all"
          inverse="true" lazy="false">
          <key column="category_id" />
          <index column="seq_num" />
          <one-to-many class="CompletedWizardPage" />
      </list>

      <list name="childCategories" cascade="all"
          inverse="true" lazy="false">
          <key column="parent_category_id" />
          <index column="seq_num" />
          <one-to-many class="CompletedWizardCategory" />
      </list>
   </class>

   <class name="CompletedWizardPage" table="osp_completed_wizard_page">
      <cache usage="nonstrict-read-write"/>
      <id name="id" length="36" type="org.sakaiproject.metaobj.shared.IdType" column="id">
         <generator class="org.sakaiproject.metaobj.shared.IdGenerator"/>
      </id>

      <many-to-one name="category" column="completed_category_id"
          not-null="false" class="CompletedWizardCategory" cascade="none" />

      <many-to-one name="wizardPageDefinition" column="wizard_page_def_id"
          not-null="false" class="WizardPageSequence" cascade="none" />

      <many-to-one name="wizardPage" column="wizard_page_id"
         not-null="false" class="org.theospi.portfolio.matrix.model.WizardPage"
         cascade="all" unique="true" />

      <property name="sequence" type="int" column="seq_num" not-null="false"/>
      <property name="created" type="java.util.Date" update="false" not-null="true"/>
      <property name="lastVisited" type="java.util.Date" update="true" not-null="false"/>

   </class>

</hibernate-mapping>